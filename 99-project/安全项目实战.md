# 目标
设计一个小安全工具，包括监听是否新用户增加，用户是否增加了信任的ssh key, 以root身份登陆的时间，与外部发起的连接监听，监听连接ip 端口记录，监听敏感进程是否被kill等

# 分析监控目标跟ebpf钩子
| 监控目标           | 内核函数 / 事件                  | 类型        | 说明                                  |
|--------------------|----------------------------------|-------------|---------------------------------------|
| 新用户增加         | sys_newuser / useradd            | tracepoint  | 监控用户创建系统调用或 useradd 命令   |
| SSH 信任密钥添加   | vfs_write（针对 .ssh/authorized_keys） | kprobe      | 监控敏感文件写入                      |
| root 身份登录      | pam_authenticate / sshd 进程     | uprobe      | 监控认证过程或 sshd 特权登录          |
| 外部连接发起       | __sys_connect                    | kretprobe   | 捕获出站连接的 IP / 端口              |
| 敏感进程被 kill    | sys_kill / sys_tgkill            | tracepoint  | 监控进程终止系统调用                  |


# userspace
解析事件，结合规则引擎（如检测敏感路径、异常 IP），生成结构化日志



